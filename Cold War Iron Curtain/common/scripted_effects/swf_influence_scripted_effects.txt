new_influence_setup = {
	every_country = {
		limit = {
			OR = {
				tag = SKK
				tag = LOP
				tag = SEE
				tag = WAZ
				tag = SIN
				tag = KAY
				tag = SRL
				tag = RAJ
				tag = BHU
				tag = AFG
				tag = NEP
				tag = BRM
				tag = PAK
				tag = TAL  
				tag = BAL
				tag = BAN
				tag = ASA
				tag = KHA
				tag = KAS
				tag = TIB
			}
			add_to_array = {
				global.south_asia_region = THIS.id
			}
			set_country_flag = region_sorted
		}
	}

}
swf_experiment_script = {
	set_variable = {
		influence_array_val^0 = 10
	}
	set_variable = {
		influence_array_val^1 = 25
	}
	set_variable = {
		influence_array_val^2 = 5
	}
	set_variable = {
		domestic_influence_amount = 20
	}
	#recalculate_influence = yes
	RegionalInfluence_calcXY = yes
}
regional_influence_clamp_influences = {
	if = {
		limit = { check_variable = { influence_array_val^0 < 0 } }
		set_variable = { influence_array_val^0 = 0 }
	}
	if = {
		limit = { check_variable = { influence_array_val^1 < 0 } }
		set_variable = { influence_array_val^1 = 0 }
	}
	if = {
		limit = { check_variable = { influence_array_val^2 < 0 } }
		set_variable = { influence_array_val^2 = 0 }
	}
	if = {
		limit = { check_variable = { domestic_influence_amount < 0 } }
		set_variable = { domestic_influence_amount = 0 }
	}
	
	set_temp_variable = { ABC = influence_array_val^0 }
	add_to_temp_variable = { ABC = influence_array_val^1 }
	add_to_temp_variable = { ABC = influence_array_val^2 }
	add_to_temp_variable = { ABC = domestic_influence_amount }

	set_variable = { regional_index_1 = influence_array_val^0 }
	set_variable = { regional_index_2 = influence_array_val^1 }
	set_variable = { regional_index_3 = influence_array_val^2 }
	set_variable = { regional_index_4 = domestic_influence_amount }
	
	
	divide_temp_variable = { ABC = 99 }
	divide_variable = { regional_index_1 = ABC }
	divide_variable = { regional_index_2 = ABC }
	divide_variable = { regional_index_3 = ABC }
	divide_variable = { regional_index_4 = ABC }
}

RegionalInfluence_calcXY = {
	regional_influence_clamp_influences = yes

	set_temp_variable = { A = regional_index_1 }
	set_temp_variable = { B = regional_index_2 }
	set_temp_variable = { C = regional_index_3 }
	set_temp_variable = { I = regional_index_4 }

	set_temp_variable = { ABC = A }
	add_to_temp_variable = { ABC = B }
	add_to_temp_variable = { ABC = C }
	add_to_temp_variable = { ABC = I }

	#x = 215 y = 275 CENTER

	# 1/2 * ((B-A)/(A+B+C))
	set_variable = { RegionalInfluence_X = B }
	subtract_from_variable = { RegionalInfluence_X = A }
	divide_variable = { RegionalInfluence_X = ABC }


	# sqrt(3)/2 * ((C)/(A+B+C))
	set_variable = { RegionalInfluence_Y = C }
	divide_variable = { RegionalInfluence_Y = ABC }

	multiply_variable = { RegionalInfluence_X = 217 }
	multiply_variable = { RegionalInfluence_Y = 375 }
	multiply_variable = { RegionalInfluence_Y = -1 }
	add_to_variable = { RegionalInfluence_Y = 365 } 	#395
	add_to_variable = { RegionalInfluence_X = 215 } 

	#x = 215 y = 275 CENTER 
	set_variable = { x_backup = RegionalInfluence_X }
	set_variable = { y_backup = RegionalInfluence_Y }
	
	set_variable = { regional_index_4_calc = regional_index_4 }
	multiply_variable = { regional_index_4_calc = 0.01 }
	#Y Adjustment
	if = {
		limit = {
			check_variable = {
				RegionalInfluence_Y > 271
			}
		}
		set_temp_variable = { y_domestic_adjustment = regional_index_4_calc }
		set_temp_variable = { y_domestic_adjustment2 = RegionalInfluence_Y }
		subtract_from_temp_variable = { y_domestic_adjustment2 = 271 }
		multiply_temp_variable = { y_domestic_adjustment2 = y_domestic_adjustment }
		subtract_from_variable = {
			RegionalInfluence_Y = y_domestic_adjustment2
		}
	}
	#if = {
	#	limit = {
	#		check_variable = {
	#			RegionalInfluence_Y < 271
	#		}
	#	}
	#	set_temp_variable = { y_domestic_adjustment = regional_index_4_calc }
	#	set_temp_variable = { y_domestic_adjustment2 = RegionalInfluence_Y }
	#	subtract_from_temp_variable = { y_domestic_adjustment2 = 271 }
	#	multiply_temp_variable = { y_domestic_adjustment2 = -1 }
	#	multiply_temp_variable = { y_domestic_adjustment2 = y_domestic_adjustment }
	#	add_to_variable = {
	#		RegionalInfluence_Y = y_domestic_adjustment2
	#	}
	#}

	#X Adjustment
	if = {
		limit = {
			check_variable = {
				RegionalInfluence_X > 215
			}
		}
		set_temp_variable = { x_domestic_adjustment = regional_index_4_calc }
		set_temp_variable = { x_domestic_adjustment2 = RegionalInfluence_X }
		subtract_from_temp_variable = { x_domestic_adjustment2 = 215 }
		multiply_temp_variable = { x_domestic_adjustment2 = x_domestic_adjustment }
		subtract_from_variable = {
			RegionalInfluence_X = x_domestic_adjustment2
		}
	}
	if = {
		limit = {
			check_variable = {
				RegionalInfluence_X < 215
			}
		}
		set_temp_variable = { x_domestic_adjustment = regional_index_4_calc }
		set_temp_variable = { x_domestic_adjustment2 = RegionalInfluence_X }
		subtract_from_temp_variable = { x_domestic_adjustment2 = 215 }
		multiply_temp_variable = { x_domestic_adjustment2 = -1 }
		multiply_temp_variable = { x_domestic_adjustment2 = x_domestic_adjustment }
		add_to_variable = {
			RegionalInfluence_X = x_domestic_adjustment2
		}
	}

}
